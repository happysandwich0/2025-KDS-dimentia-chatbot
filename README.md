# 🍊 AI 기반 노년층 대화 분석 및 인지 건강 모니터링 시스템

| AI 기반 웨어러블 연동 대화형 일기장 또랑이 : 독거노인 치매 위험 조기 발견 시스템  
| [K-DATA SCIENCE 해커톤] 우수상 수상

---


## 🌟 PROJECT

이 프로젝트는 **생성형 AI 챗봇**과 **고도화된 머신러닝 분석 모듈**을 결합하여, 노년층 사용자의 일상 대화 패턴과 라이프로그 데이터를 실시간으로 분석하고 인지 건강 상태의 **이상 징후**를 조기에 감지하는 지능형 모니터링 시스템입니다. 특히, 대화 로그를 **MMSE(Mini-Mental State Examination)** 문항 기반으로 구조화하고, 시계열적 이상 징후를 판별하여 상세한 **파이널 리포트**를 제공하는 것이 핵심 목표입니다.

---

## 💡 IDEA

| 아이디어 | 설명 |
| :--- | :--- |
| **대화 패턴의 MMSE 구조화** | 단순한 대화 분석을 넘어, 챗봇이 수집한 발화 뭉치를 **MMSE 7개 항목** (예: 지남력, 기억 등록, 주의 집중 등)에 대응하는 분류 기준으로 라벨링하여, 인지 기능 저하 징후를 정량적으로 분석할 수 있는 데이터를 생성합니다. |
| **LLM + Tool Use 기반 고성능 챗봇** | 사투리 교정, 사실 추출/검증, 응답 생성 과정을 **GPT-4o의 Function Calling (Tool Use)** 및 **비동기 배치 처리**를 통해 통합하여, API 호출 횟수를 최소화하고 사용자 응답 지연 시간(Latency)을 획기적으로 개선했습니다. |
| **다중 신호 이상 탐지 (Multi-Signal Anomaly Detection)** | 챗봇 대화 분석 결과와 별도의 **라이프로그 예측 모델** 데이터를 결합합니다. **시계열적 이상 탐지 모델**을 통해 두 신호의 변화 추이를 통합 분석하여, 인지 건강의 급격한 변화나 위험을 판별합니다. |

---

## 📊 AI-Hub DATA

프로젝트의 LLM 파인튜닝, 텍스트 분류, 라이프로그 예측 모델 학습에는 다음과 같은 AI-Hub 공개 데이터를 활용했습니다.  

* **감성 대화 말뭉치**: [감성 대화 말뭉치](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&dataSetSn=86)
    > *챗봇의 기본 대화 응답 및 공감 능력 강화에 활용.*
* **고령자 근현대 경험 기반 스토리 구술 데이터**: [고령자 근현대 경험 기반 스토리 구술 데이터](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&dataSetSn=71703)
    > *노년층 특화 주제 이해 및 자연스러운 회상 대화 패턴 학습에 활용.*
* **한국어 멀티세션 대화**: [한국어 멀티세션 대화](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&dataSetSn=71630)
    > *맥락 유지 및 장기 대화 세션 관리를 위한 데이터 구조 학습에 활용.*
* **치매 고위험군 웨어러블 라이프로그**: [치매 고위험군 웨어러블 라이프로그](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&dataSetSn=226)
    > *라이프로그 예측 모델(`Lifelog Predictor`)의 학습 및 이상치 탐지 기준 마련에 활용.*

---
## 🛠️ MODEL

### 1. 💬 Chatbot Core & Performance (LLM 기반)

* **주요 기능**: 대화 수집, 사투리 교정, 메모리 관리(Fact Memory), 일기장 모드.
* **기능**: **OpenAI GPT-4o, Function Calling/Tool Use, Asyncio**.

### 2. 📝 Text Classifier (발화 뭉치 구조화)

* **목표**: 챗봇 코어가 수집한 사용자 발화 뭉치(Utterance Chunk)를 MMSE 항목에 따라 분류하고 정량화된 라벨을 부여합니다.
* **라벨링 항목**: 지남력, 기억 등록, 주의 집중 및 계산, 기억 회상, 언어 능력, 시/공간 구성, 수행 능력 등 인지 기능 관련 라벨.

### 3. 📉 Anomaly Detection (이상 탐지 및 모니터링)

* **목표**: 분류된 텍스트 데이터와 라이프로그 예측 데이터를 시계열적으로 분석하여 사용자의 **급격한 인지 변화(Anomaly)**를 판별합니다.
* **기능**: **시계열 이상 탐지 알고리즘** (예: Isolation Forest, One-Class SVM 또는 딥러닝 기반 Autoencoder)을 활용하여 정상 범주에서 벗어난 패턴을 실시간으로 감지합니다.

### 4. 📈 Lifelog Predictor (라이프로그 데이터 연동)

* **목표**: 실제 사용자의 건강 기록(라이프로그) 또는 모의 데이터를 기반으로 치매 위험도(DemRisk)를 예측합니다.
* **기능**: 인코더와 예측 모델을 사용하여 MMSE 점수나 인지 건강 위험도에 영향을 미치는 외부 요인(수면, 활동량 등)을 모델링하고, 예측값을 이상 탐지 모듈에 제공합니다.

---

## REPORT

* **MMSE 기반 인지 영역별 분석**: 텍스트 분류기가 매긴 영역별 점수 추이.
* **메모리 일관성 점수(Memory Consistency Score)**: LLM이 실시간으로 추적한 사용자 발화의 사실 일관성 지표.
* **이상 탐지 경고**: 대화 패턴과 라이프로그 예측값에서 감지된 시계열적 이상 징후 발생 여부 및 심각도.
* **라이프로그 예측**: 외부 건강 요인을 기반으로 예측된 인지 건강 위험도.
